import React, { useState } from 'react'; import { useNavigate, Link } from 'react-router-dom'; import { useDocenteAuth } from '../../contexts/DocenteAuthContext'; import { docenteAuthApi } from '../../services/docenteApi'; import { toast } from 'react-toastify'; import { EyeIcon, EyeSlashIcon, EnvelopeIcon, LockClosedIcon } from '@heroicons/react/24/outline'; export const LoginDocentePage: React.FC = () => { const navigate = useNavigate(); const { login } = useDocenteAuth(); const [correo, setCorreo] = useState(''); const [password, setPassword] = useState(''); const [showPassword, setShowPassword] = useState(false); const [isLoading, setIsLoading] = useState(false); const [errors, setErrors] = useState<{ correo?: string; password?: string }>({}); const validateForm = (): boolean => { const newErrors: { correo?: string; password?: string } = {}; if (!correo) { newErrors.correo = 'El correo es requerido'; } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(correo)) { newErrors.correo = 'El formato del correo no es válido'; } if (!password) { newErrors.password = 'La contraseña es requerida'; } else if (password.length < 6) { newErrors.password = 'La contraseña debe tener al menos 6 caracteres'; } setErrors(newErrors); return Object.keys(newErrors).length === 0; }; const handleSubmit = async (e: React.FormEvent) => { e.preventDefault(); if (!validateForm()) { return; } setIsLoading(true); try { const response = await docenteAuthApi.login({ correo, password }); login(response); toast.success(`¡Bienvenido ${response.nombreCompleto}!`); navigate('/docente/dashboard'); } catch (error: any) { console.error('Error en login de docente:', error); if (error.response?.status === 401) { toast.error('Correo o contraseña incorrectos'); } else if (error.response?.status === 400) { toast.error('Datos de entrada inválidos'); } else { toast.error('Error al iniciar sesión. Por favor, intente nuevamente'); } } finally { setIsLoading(false); } }; return ( <div className="min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 relative" style={{ backgroundImage: `url('https://images.unsplash.com/photo-1562774053-701939374585?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1986&q=80')`, backgroundSize: 'cover', backgroundPosition: 'center', backgroundRepeat: 'no-repeat'}} > {/* Overlay */} <div className="absolute inset-0" style={{ backdropFilter: 'blur(3px)', backgroundColor: 'rgba(8, 8, 8, 0.3)'}} /> {/* Contenedor Principal */} <div className="relative max-w-md w-full bg-white p-8 sm:p-10 shadow-2xl border border-zinc-200/50" style={{  boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)'}} > {/* Logo y Marca */} <div className="text-center mb-8"> <div className="mx-auto w-20 h-24 relative mb-4"> <img src="/src/image/fondouni.svg" alt="Escudo Universitario" className="w-full h-full object-contain" /> </div> <h1 className="text-xl font-bold tracking-wider text-zinc-800 mb-2"> UNIVERSIDAD ACADEMICA </h1> <h2 className="text-2xl font-bold text-zinc-800"> Portal Docente </h2> </div> {/* Formulario */} <form onSubmit={handleSubmit} className="space-y-6"> {/* Campo Correo */} <div> <label htmlFor="correo" className="block text-sm font-medium mb-2 text-zinc-700" > Correo Institucional </label> <div className="relative"> <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"> <EnvelopeIcon className="h-5 w-5 text-gray-400" /> </div> <input id="correo" type="email" value={correo} onChange={(e) => { setCorreo(e.target.value); if (errors.correo) setErrors({ ...errors, correo: undefined }); }} className={`block w-full pl-10 pr-3 py-3 border ${errors.correo ? 'border-red-400' : 'border-zinc-200' } focus:outline-none focus:ring-2 focus:ring-zinc-500/20 focus:border-zinc-400 transition-all duration-200 text-zinc-900 bg-white/80`} placeholder="docente@unas.edu.pe" /> </div> {errors.correo && ( <p className="mt-1 text-sm text-red-600">{errors.correo}</p> )} </div> {/* Campo Contraseña */} <div> <label htmlFor="password" className="block text-sm font-medium mb-2 text-zinc-700" > Contraseña </label> <div className="relative"> <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"> <LockClosedIcon className="h-5 w-5 text-gray-400" /> </div> <input id="password" type={showPassword ? 'text' : 'password'} value={password} onChange={(e) => { setPassword(e.target.value); if (errors.password) setErrors({ ...errors, password: undefined }); }} className={`block w-full pl-10 pr-12 py-3 border ${errors.password ? 'border-red-400' : 'border-zinc-200' } focus:outline-none focus:ring-2 focus:ring-zinc-500/20 focus:border-zinc-400 transition-all duration-200 text-zinc-900 bg-white/80`} placeholder="••••••••" /> <button type="button" onClick={() => setShowPassword(!showPassword)} className="absolute inset-y-0 right-0 pr-3 flex items-center" > {showPassword ? ( <EyeSlashIcon className="h-5 w-5 text-gray-400 hover:text-gray-600" /> ) : ( <EyeIcon className="h-5 w-5 text-gray-400 hover:text-gray-600" /> )} </button> </div> {errors.password && ( <p className="mt-1 text-sm text-red-600">{errors.password}</p> )} </div> {/* Botón de Login */} <button type="submit" disabled={isLoading} className={`w-full flex justify-center items-center py-3.5 px-4 text-white font-medium transition-all duration-200 bg-zinc-700 hover:bg-zinc-600 disabled:opacity-50 disabled:cursor-not-allowed ${ isLoading ? 'cursor-not-allowed opacity-50' : 'hover:shadow-lg' }`} > {isLoading ? ( <> <svg className="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"> <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle> <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path> </svg> Iniciando sesión... </> ) : ( 'Ingresar al Portal' )} </button> </form> {/* Link para recuperar contraseña */} <div className="mt-6 text-center"> <Link to="/docente/forgot-password" className="text-sm font-medium hover:underline text-zinc-600 hover:text-zinc-900 transition-all" > ¿Olvidó su contraseña? </Link> </div> {/* Footer */} <div className="mt-8 pt-6 border-t border-zinc-200 text-center"> <p className="text-xs text-zinc-500"> Tu futuro comienza aquí. </p> </div> </div> </div> ); }; export default LoginDocentePage; 